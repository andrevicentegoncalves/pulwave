# Vulnerability Detection Patterns

Standardized patterns and regex for auditing security vulnerabilities.

## 1. Hardcoded Secrets
*Focus*: API keys, tokens, and passwords in source code.

**Detection Patterns:**
- `/(API_KEY|TOKEN|SECRET|PASSWORD)\s*=\s*["'][a-zA-Z0-9_\-]{20,}["']/i`
- `/(AWS_ACCESS_KEY|AWS_SECRET|PRIVATE_KEY)/i`
- Search for entropy: `/[a-z0-9+/]{40,}/i` (potential base64 keys)

**Severities:**
- **CRITICAL**: Production AWS/DB/SaaS keys.
- **HIGH**: Staging/Dev credentials.

## 2. SQL Injection (SQLi)
*Focus*: String concatenation in SQL instead of parameters.

**Detected Patterns:**
- `db.execute("..." + var)`
- `${var}` inside SQL template strings.
- `f"SELECT ... {var}"` (Python).

**Severities:**
- **CRITICAL**: User-input concatenated directly.
- **HIGH**: Variable concatenation in production models.

## 3. Cross-Site Scripting (XSS)
*Focus*: Unsanitized rendering in the browser.

**Detected Patterns:**
- `dangerouslySetInnerHTML` (React).
- `innerHTML` (JS).
- `untrustworthy_var | safe` (Jinja/Templates).

**Severities:**
- **CRITICAL**: Direct rendering of URL params or User-generated content.

## 4. Input Validation
*Focus*: Boundaries (API, Forms, Files).

**Checklist:**
- [ ] Are API routes wrapped in a validation schema (Joi/Zod)?
- [ ] Do file uploads check for MIME-type AND extension?
- [ ] Is CORS configured to a whitelist?

## Scoring (Penalty System)
- **Critical Violation**: -2 points
- **High Violation**: -1 point
- **Medium Violation**: -0.5 points
- **Low Violation**: -0.2 points
*Base Score*: 10/10.
