@use 'sass:map';
@use 'sass:string';
@use '../helpers/typography' as typography;
@use '../../variables/semantics/typography' as type-vars;

// ========================================================================== //
//                    GENERATOR: TYPOGRAPHY UTILITIES                         //
// ========================================================================== //

/// Generate ALL typography-related utilities
@mixin generate-all-typography-utilities() {
  @include generate-font-family-utilities();
  @include generate-font-weight-utilities();
  @include generate-font-style-utilities();
  @include generate-typography-preset-utilities();
  @include generate-text-alignment-utilities();
  @include generate-text-transform-utilities();
  @include generate-text-decoration-utilities();
  @include generate-text-wrapping-utilities();
}

// -------------------------------------------------------------------------- //
//                         FONT FAMILY UTILITIES                              //
// -------------------------------------------------------------------------- //

@mixin generate-font-family-utilities() {
  .font-sans {
    font-family: var(--font-family-sans);
  }

  .font-serif {
    font-family: var(--font-family-serif);
  }

  .font-mono {
    font-family: var(--font-family-mono);
  }

  .font-display {
    font-family: var(--font-family-display);
  }
}

// -------------------------------------------------------------------------- //
//                         FONT WEIGHT UTILITIES                              //
// -------------------------------------------------------------------------- //

@mixin generate-font-weight-utilities() {
  .font-thin {
    font-weight: var(--font-weight-thin);
  }

  .font-light {
    font-weight: var(--font-weight-light);
  }

  .font-regular {
    font-weight: var(--font-weight-regular);
  }

  .font-medium {
    font-weight: var(--font-weight-medium);
  }

  .font-semibold {
    font-weight: var(--font-weight-semi-bold);
  }

  .font-bold {
    font-weight: var(--font-weight-bold);
  }
}

// -------------------------------------------------------------------------- //
//                         FONT STYLE UTILITIES                               //
// -------------------------------------------------------------------------- //

@mixin generate-font-style-utilities() {
  .font-italic {
    font-style: italic;
  }

  .font-normal {
    font-style: normal;
  }
}

// -------------------------------------------------------------------------- //
//                      TYPOGRAPHY PRESET UTILITIES                           //
// -------------------------------------------------------------------------- //

/// Generate utility classes for all typography presets (mobile-first)
/// Output: .text-body-m, .text-headline-xl, etc.
@mixin generate-typography-preset-utilities() {

  // Body Presets - dynamically generated from map
  @include generate-category-utilities('body', map.keys(type-vars.$typography-body), ('light', 'regular', 'semi-bold', 'bold'));

  // Title Presets - dynamically generated from map
  @include generate-category-utilities('title', map.keys(type-vars.$typography-title), ('medium', 'bold'));

  // Headline Presets - dynamically generated from map
  @include generate-category-utilities('headline', map.keys(type-vars.$typography-headline), ('medium', 'bold'));

  // Caption Presets - dynamically generated from map
  @include generate-category-utilities('caption', map.keys(type-vars.$typography-caption), ('light', 'regular', 'semi-bold', 'bold'));

  // Label Presets - dynamically generated from map
  @each $size in map.keys(type-vars.$typography-label) {
    .text-label-#{$size} {
      @include typography.typography('label', $size, 'medium');
    }
  }

  // Action Presets (Buttons & Links) - dynamically generated from map
  @each $key in map.keys(type-vars.$typography-action) {
    .text-#{$key} {
      // Determine weight based on key type
      $weight: 'medium';

      @if string.index($key, 'link') {
        $weight: 'regular';
      }

      @include typography.typography('action', $key, $weight);
    }
  }

  // Eyebrow Presets - dynamically generated from map
  @each $size in map.keys(type-vars.$typography-eyebrow) {
    .text-eyebrow-#{$size} {
      @include typography.typography('eyebrow', $size, 'bold');
    }
  }

  // Price Presets - dynamically generated from map
  @each $size in map.keys(type-vars.$typography-price) {
    .text-price-#{$size} {
      @include typography.typography('price', $size, 'bold');
    }
  }
}

/// Generate utilities for a specific category (mobile-first)
/// @param {String} $category - Typography category (body, title, headline, etc.)
/// @param {List} $sizes - List of size variants
/// @param {List} $weights - List of weight variants
@mixin generate-category-utilities($category, $sizes, $weights) {
  @each $size in $sizes {

    // Base class without weight
    .text-#{$category}-#{$size} {
      @include typography.typography($category, $size);
    }

    // Weight variants
    @each $weight in $weights {
      .text-#{$category}-#{$size}-#{$weight} {
        @include typography.typography($category, $size, $weight);
      }
    }
  }
}

// -------------------------------------------------------------------------- //
//                         TEXT ALIGNMENT UTILITIES                           //
// -------------------------------------------------------------------------- //

@mixin generate-text-alignment-utilities() {
  .text-left {
    text-align: left;
  }

  .text-center {
    text-align: center;
  }

  .text-right {
    text-align: right;
  }

  .text-justify {
    text-align: justify;
  }
}

// -------------------------------------------------------------------------- //
//                         TEXT TRANSFORM UTILITIES                           //
// -------------------------------------------------------------------------- //

@mixin generate-text-transform-utilities() {
  .text-uppercase {
    text-transform: uppercase;
  }

  .text-lowercase {
    text-transform: lowercase;
  }

  .text-capitalize {
    text-transform: capitalize;
  }

  .text-normal-case {
    text-transform: none;
  }
}

// -------------------------------------------------------------------------- //
//                         TEXT DECORATION UTILITIES                          //
// -------------------------------------------------------------------------- //

@mixin generate-text-decoration-utilities() {
  .text-underline {
    text-decoration: underline;
  }

  .text-line-through {
    text-decoration: line-through;
  }

  .text-no-underline {
    text-decoration: none;
  }
}

// -------------------------------------------------------------------------- //
//                         TEXT WRAPPING UTILITIES                            //
// -------------------------------------------------------------------------- //

@mixin generate-text-wrapping-utilities() {
  .text-wrap {
    white-space: normal;
  }

  .text-nowrap {
    white-space: nowrap;
  }

  .text-truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
}