@use 'sass:map';
@use '../../variables/semantics/grid' as semantics;

// ========================================================================== //
//                      MIXINS: GRID FOUNDATION                               //
// ========================================================================== //
// Core grid system mixins for base functionality
// These mixins provide the fundamental building blocks for the grid system
// ========================================================================== //

// ========================================================================== //
//                    MIXIN: UPDATE ACTIVE GRID TOKENS                        //
// ========================================================================== //
// Updates the active grid tokens for a specific breakpoint
// Used in media queries for progressive enhancement
//
// @param {String} $breakpoint - Breakpoint name (xs, s, m, l, xl, 2xl)
//
// @example
//   @media (min-width: 768px) {
//     :root {
//       @include update-active-grid-tokens('m');
//     }
//   }
// ========================================================================== //

@mixin update-active-grid-tokens($breakpoint) {
  --grid-columns: var(--grid-#{$breakpoint}-columns);
  --grid-gutter: var(--grid-#{$breakpoint}-gutter);
  --grid-margin: var(--grid-#{$breakpoint}-margin);
  --grid-max-width: var(--grid-#{$breakpoint}-max-width);
  --grid-type: var(--grid-#{$breakpoint}-type);
  --grid-column-width: var(--grid-#{$breakpoint}-column-width);
  --grid-content-width: var(--grid-#{$breakpoint}-content-width);
  --grid-active-breakpoint: '#{$breakpoint}';
}

// ========================================================================== //
//                    MIXIN: GRID CONTAINER                                   //
// ========================================================================== //
// Creates a container with responsive max-width and padding
// Uses CSS custom properties for flexibility
//
// @param {Boolean} $fluid - If true, no max-width constraint
//
// @example
//   .container {
//     @include grid-container();
//   }
//
//   .container-fluid {
//     @include grid-container($fluid: true);
//   }
// ========================================================================== //

@mixin grid-container($fluid: false) {
  width: 100%;
  padding-inline: var(--container-padding);
  margin-inline: auto;
  
  @if not $fluid {
    max-width: var(--container-max-width);
  }
}

// ========================================================================== //
//                    MIXIN: GRID LAYOUT                                      //
// ========================================================================== //
// Creates a CSS Grid layout using the grid system tokens
//
// @param {Number} $columns - Optional: Override column count (default: uses active grid columns)
// @param {String} $gap - Optional: Override gap (default: uses active grid gutter)
//
// @example
//   .grid {
//     @include grid-layout();
//   }
//
//   .grid-4-cols {
//     @include grid-layout(4);
//   }
//
//   .grid-custom {
//     @include grid-layout(6, 2rem);
//   }
// ========================================================================== //

@mixin grid-layout($columns: null, $gap: null) {
  display: grid;
  grid-template-columns: if($columns, repeat($columns, 1fr), var(--grid-template-columns));
  gap: if($gap, $gap, var(--grid-gap));
}

// ========================================================================== //
//                    MIXIN: GRID SPAN                                        //
// ========================================================================== //
// Sets a grid item to span a specific number of columns
//
// @param {Number} $span - Number of columns to span
//
// @example
//   .grid-item {
//     @include grid-span(6);
//   }
// ========================================================================== //

@mixin grid-span($span) {
  grid-column: span $span;
}

// ========================================================================== //
//                    MIXIN: GRID SPAN RESPONSIVE                             //
// ========================================================================== //
// Sets responsive column spans for different breakpoints (Mobile-First)
//
// @param {Map} $spans - Map of breakpoint to span values
//
// @example
//   .grid-item {
//     @include grid-span-responsive((
//       xs: 4,
//       m: 8,
//       l: 6
//     ));
//   }
// ========================================================================== //

@mixin grid-span-responsive($spans) {
  @each $breakpoint, $span in $spans {
    @if $breakpoint == 'xs' {
      grid-column: span $span;
    } @else {
      @media (min-width: var(--breakpoint-#{$breakpoint})) {
        grid-column: span $span;
      }
    }
  }
}
