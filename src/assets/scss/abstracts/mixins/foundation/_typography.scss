@use 'sass:map';
@use 'sass:string';
@use '../../functions/foundation/unit-conversion' as units;
@use '../../functions/foundation/typography-scale' as type-fn;
@use 'breakpoints' as bp;

@mixin generate-semantic-tokens($type, $map) {
  /* ========================================================================== */
  /*                  TOKENS: TYPOGRAPHY PRESET - #{string.to-upper-case($type)} */
  /* ========================================================================== */

  @each $size, $props in $map {
    /* --- #{$type}-#{$size} --- */
    --font-size-#{$type}-#{$size}: #{map.get($props, 'size-desktop')};
    --font-size-#{$type}-#{$size}-phone: #{map.get($props, 'size-phone')};
    --line-height-#{$type}-#{$size}: #{map.get($props, 'line-height')};
    --letter-spacing-#{$type}-#{$size}: #{map.get($props, 'letter-spacing')};

    @each $weight in ('light', 'regular', 'medium', 'semi-bold', 'bold') {
      $weight-key: 'weight-#{$weight}';

      @if map.has-key($props, $weight-key) {
        --font-weight-#{$type}-#{$size}-#{$weight}: #{map.get($props, $weight-key)};
      }
    }

    @if map.has-key($props, 'text-transform') {
      --text-transform-#{$type}-#{$size}: #{map.get($props, 'text-transform')};
    }
  }
}

/// Responsive typography mixin
/// @param {String} $category - Typography category
/// @param {String} $size - Size key
/// @param {String} $weight - Weight variant (bold, medium)
@mixin typography-responsive($category, $size, $weight: 'bold') {
  // Desktop (default)
  font-size: units.rem(type-fn.typography($category, $size, 'size-desktop'));
  line-height: type-fn.typography($category, $size, 'line-height');
  letter-spacing: type-fn.typography($category, $size, 'letter-spacing');
  font-weight: type-fn.typography($category, $size, 'weight-#{$weight}');

  // Phone (responsive)
  @include bp.bp-down('s') {
    font-size: units.rem(type-fn.typography($category, $size, 'size-phone'));
  }
}