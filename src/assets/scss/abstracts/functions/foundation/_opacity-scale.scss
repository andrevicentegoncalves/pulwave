@use 'sass:map';
@use 'sass:math';
@use '../../variables/foundation/opacity-scale' as scale;

// ============================================================================ //
//                    FUNCTIONS: FOUNDATION - OPACITY SCALE                     //
// ============================================================================ //

/// Get opacity from numeric scale
/// @param {Number} $percentage - Percentage value (0-100)
/// @return {Number} Opacity value (0-1)
@function opacity($percentage) {
  @if map.has-key($opacity-scale, $percentage) {
    @return map.get($opacity-scale, $percentage);
  }
  @error "Opacity '#{$percentage}' not found. Available: #{map.keys($opacity-scale)}";
}

/// Get semantic opacity value
/// @param {String} $name - Semantic name
/// @return {Number} Opacity value (0-1)
@function opacity-semantic($name) {
  @if map.has-key($opacity-semantic, $name) {
    @return map.get($opacity-semantic, $name);
  }
  @error "Semantic opacity '#{$name}' not found. Available: #{map.keys($opacity-semantic)}";
}

/// Convert percentage to opacity
/// @param {Number} $percentage - Percentage (0-100)
/// @return {Number} Opacity value (0-1)
@function percent-to-opacity($percentage) {
  @return math.div($percentage, 100);
}

/// Convert opacity to percentage
/// @param {Number} $opacity - Opacity value (0-1)
/// @return {Number} Percentage (0-100)
@function opacity-to-percent($opacity) {
  @return $opacity * 100;
}

/// Create rgba color with opacity from scale
/// @param {Color} $color - Base color
/// @param {Number|String} $opacity - Opacity key or semantic name
/// @return {Color} RGBA color
@function color-with-opacity($color, $opacity-key) {
  $opacity-value: null;
  
  @if map.has-key($opacity-scale, $opacity-key) {
    $opacity-value: map.get($opacity-scale, $opacity-key);
  } @else if map.has-key($opacity-semantic, $opacity-key) {
    $opacity-value: map.get($opacity-semantic, $opacity-key);
  } @else {
    @error "Opacity '#{$opacity-key}' not found in either scale or semantic map";
  }
  
  @return rgba($color, $opacity-value);
}