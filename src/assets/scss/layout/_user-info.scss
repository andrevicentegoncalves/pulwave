@use '../abstracts/mixins/foundation/breakpoints' as bp;
@use '../abstracts/mixins/foundation/typography' as typography;

// ============================================================================ //
//                         USER INFO COMPONENT STYLES                           //
// ============================================================================ //

.user-info__avatar {
  width: var(--scale-12); // 48px
  height: var(--scale-12);
  border-radius: var(--border-radius-round);
  object-fit: cover;
  flex-shrink: 0;
  cursor: pointer;
  transition: all var(--duration-fast) var(--easing-standard);

  &:hover {
    transform: scale(1.05);
    border-color: color-mix(in srgb, var(--color-on-primary), transparent calc(100% - var(--opacity-medium) * 100%));
  }

  &:focus-visible {
    outline: var(--focus-width) solid var(--color-on-primary);
    outline-offset: var(--focus-offset);
  }

  &:active {
    transform: scale(1.0);
  }
}

// ---------------------------------------------------------------------------//
// NAME & EMAIL DETAILS
// ---------------------------------------------------------------------------//

.user-info__details {
  display: flex;
  flex-direction: column;
  min-width: 0; // Allow text truncation
  flex: 1; // Take available space
  gap: var(--spacing-1); // 4px between name and email
}

.user-info__name {
  color: var(--color-on-primary); // White text
  @include typography.typography-responsive('label', 'm', 'semi-bold'); // 16px
  line-height: var(--line-height-tight); // 1.25
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.user-info__email {
  color: color-mix(in srgb, var(--color-on-primary), transparent calc(100% - var(--opacity-muted) * 100%)); // Subtle white
  @include typography.typography-responsive('caption', 'm', 'regular'); // 12px
  line-height: var(--line-height-tight); // 1.25
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

// ---------------------------------------------------------------------------//
// LOGOUT BUTTON
// ---------------------------------------------------------------------------//

.user-info__logout {
  background: color-mix(in srgb, var(--color-on-primary), transparent calc(100% - var(--opacity-hover) * 100%));
  border: none;
  width: var(--scale-10); // 40px
  height: var(--scale-10);
  border-radius: var(--border-radius-round); // Circle
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-on-primary); // White
  cursor: pointer;
  transition: all var(--duration-fast) var(--easing-standard);
  flex-shrink: 0;

  svg {
    width: var(--icon-size-s); // 20px
    height: var(--icon-size-s);
  }

  &:hover {
    background: color-mix(in srgb, var(--color-on-primary), transparent calc(100% - var(--opacity-active) * 100%));
    transform: scale(1.05);
  }

  &:focus-visible {
    outline: var(--focus-width) solid var(--color-on-primary);
    outline-offset: var(--focus-offset);
  }

  &:active {
    background: color-mix(in srgb, var(--color-on-primary), transparent calc(100% - var(--opacity-pressed) * 100%));
    transform: scale(1.0);
  }
}

// ---------------------------------------------------------------------------//
// ORIENTATION: HORIZONTAL (DEFAULT)
// ---------------------------------------------------------------------------//

.user-info--horizontal {
  flex-direction: row;
  justify-content: flex-start;
  align-items: center;
}

// ---------------------------------------------------------------------------//
// ORIENTATION: VERTICAL
// ---------------------------------------------------------------------------//

.user-info--vertical {
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  gap: var(--spacing-2); // 8px vertical spacing

  // Avatar and details centered
  .user-info__avatar {
    margin-bottom: var(--spacing-1); // Extra spacing below avatar
  }

  // Details centered
  .user-info__details {
    align-items: center;
    text-align: center;
    width: 100%;
  }

  // Logout button centered
  .user-info__logout {
    margin-top: var(--spacing-1); // Extra spacing above logout
  }
}

// ---------------------------------------------------------------------------//
// SIZE VARIANTS
// ---------------------------------------------------------------------------//

// Small size - for mobile headers and compact displays
.user-info--s {
  padding: var(--spacing-2); // 8px
  gap: var(--spacing-2); // 8px

  .user-info__avatar {
    width: var(--scale-8); // 32px
    height: var(--scale-8);
  }

  .user-info__logout {
    width: var(--scale-8); // 32px
    height: var(--scale-8);

    svg {
      width: var(--scale-4); // 16px
      height: var(--scale-4);
    }
  }

  .user-info__name {
    @include typography.typography-responsive('label', 's', 'semi-bold'); // 14px
  }

  .user-info__email {
    @include typography.typography-responsive('caption', 's', 'regular'); // 11px
  }
}

// Large size - for prominent displays
.user-info--l {
  padding: var(--spacing-5); // 20px
  gap: var(--spacing-4); // 16px

  .user-info__avatar {
    width: var(--scale-14); // 56px
    height: var(--scale-14);
  }

  .user-info__logout {
    width: var(--scale-12); // 48px
    height: var(--scale-12);

    svg {
      width: var(--icon-size-m); // 24px
      height: var(--icon-size-m);
    }
  }

  .user-info__name {
    @include typography.typography-responsive('title', 's', 'semi-bold'); // 18px
  }

  .user-info__email {
    @include typography.typography-responsive('body', 'm', 'regular'); // 14px
  }
}

// ---------------------------------------------------------------------------//
// RESPONSIVE: COLLAPSED SIDEBAR STATE
// ---------------------------------------------------------------------------//

// When sidebar is collapsed, show minimal version
:global(.sidebar-container.collapsed) {
  .user-info {
    flex-direction: column;
    padding: var(--spacing-2); // Reduced padding
    gap: var(--spacing-2); // Smaller gap

    // Hide name/email in collapsed state
    .user-info__details {
      display: none;
    }

    // Smaller avatar
    .user-info__avatar {
      width: var(--scale-10); // 40px
      height: var(--scale-10);
    }

    // Keep logout button visible but smaller
    .user-info__logout {
      width: var(--scale-8); // 32px
      height: var(--scale-8);

      svg {
        width: var(--scale-5); // 20px
        height: var(--scale-5);
      }
    }
  }
}

// ---------------------------------------------------------------------------//
// SPECIAL CASES: SINGLE ELEMENT
// ---------------------------------------------------------------------------//

// Avatar only (no name, no logout)
.user-info:has(.user-info__avatar):not(:has(.user-info__details)):not(:has(.user-info__logout)) {
  justify-content: center;
  padding: var(--spacing-2);
}

// Logout only (no avatar, no name)
.user-info:has(.user-info__logout):not(:has(.user-info__avatar)):not(:has(.user-info__details)) {
  justify-content: center;
  padding: var(--spacing-2);
}

// Name only (no avatar, no logout)
.user-info:has(.user-info__details):not(:has(.user-info__avatar)):not(:has(.user-info__logout)) {
  justify-content: center;
  padding: var(--spacing-3) var(--spacing-4);
}

// ---------------------------------------------------------------------------//
// HOVER EFFECTS FOR CONTAINER
// ---------------------------------------------------------------------------//

// .user-info:hover {} // Removed empty ruleset

// ---------------------------------------------------------------------------//
// ACCESSIBILITY
// ---------------------------------------------------------------------------//

// High contrast mode support
@media (prefers-contrast: high) {
  .user-info {
    border: var(--border-width-1) solid rgba(255, 255, 255, 0.5);
  }

  .user-info__avatar {
    border-width: var(--border-width-2);
  }
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {

  .user-info,
  .user-info__avatar,
  .user-info__logout {
    transition: none;
  }
}

// ---------------------------------------------------------------------------//
// PRINT STYLES
// ---------------------------------------------------------------------------//

@media print {
  .user-info {
    display: none;
  }
}

// ---------------------------------------------------------------------------//
// MOBILE RESPONSIVE
// ---------------------------------------------------------------------------//

@include bp.bp-down('m') {

  // Hide user info in sidebar on mobile (shown in mobile header instead)
  .sidebar-container .user-info,
  .sidebar .user-info {
    display: none !important;
  }
}